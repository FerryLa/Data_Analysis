<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ëŒ€í•œë¯¼êµ­ ì¡°ì„ ì†ŒÂ·í•­ë§ŒÂ·ë„í¬ ì¸í„°ë™í‹°ë¸Œ ì§€ë„</title>
    
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    
    <!-- Leaflet MarkerCluster CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.4.1/dist/MarkerCluster.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.4.1/dist/MarkerCluster.Default.css" />
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Malgun Gothic', 'Apple SD Gothic Neo', sans-serif;
        }
        
        #map {
            width: 100%;
            height: calc(100vh - 60px);
        }
        
        .header {
            background: linear-gradient(135deg, #1a237e 0%, #0d47a1 100%);
            color: white;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }
        
        .header h1 {
            font-size: 1.3rem;
            font-weight: 600;
        }
        
        .header-info {
            font-size: 0.85rem;
            opacity: 0.9;
        }
        
        /* ë²”ë¡€ ìŠ¤íƒ€ì¼ */
        .legend {
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 15px rgba(0,0,0,0.2);
            font-size: 13px;
            line-height: 1.8;
        }
        
        .legend h4 {
            margin-bottom: 10px;
            color: #1a237e;
            font-size: 14px;
            border-bottom: 2px solid #1a237e;
            padding-bottom: 5px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            margin: 5px 0;
        }
        
        .legend-icon {
            width: 18px;
            height: 18px;
            border-radius: 50%;
            margin-right: 8px;
            border: 2px solid white;
            box-shadow: 0 1px 3px rgba(0,0,0,0.3);
        }
        
        /* ë ˆì´ì–´ ì»¨íŠ¸ë¡¤ */
        .layer-control {
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 15px rgba(0,0,0,0.2);
            font-size: 13px;
        }
        
        .layer-control h4 {
            margin-bottom: 10px;
            color: #1a237e;
            font-size: 14px;
            border-bottom: 2px solid #1a237e;
            padding-bottom: 5px;
        }
        
        .layer-item {
            display: flex;
            align-items: center;
            margin: 8px 0;
            cursor: pointer;
        }
        
        .layer-item input {
            margin-right: 8px;
            cursor: pointer;
            width: 16px;
            height: 16px;
        }
        
        .layer-item label {
            cursor: pointer;
        }
        
        /* íŒì—… ìŠ¤íƒ€ì¼ */
        .custom-popup .leaflet-popup-content-wrapper {
            border-radius: 8px;
            box-shadow: 0 3px 15px rgba(0,0,0,0.2);
        }
        
        .popup-content {
            font-size: 13px;
            line-height: 1.6;
            min-width: 200px;
        }
        
        .popup-content h3 {
            color: #1a237e;
            font-size: 15px;
            margin-bottom: 10px;
            padding-bottom: 8px;
            border-bottom: 2px solid #e3f2fd;
        }
        
        .popup-content .info-row {
            display: flex;
            margin: 5px 0;
        }
        
        .popup-content .info-label {
            font-weight: 600;
            color: #555;
            width: 60px;
            flex-shrink: 0;
        }
        
        .popup-content .info-value {
            color: #333;
        }
        
        .popup-content .category-badge {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            color: white;
            margin-top: 5px;
        }
        
        .badge-shipyard-large { background: #d32f2f; }
        .badge-shipyard-small { background: #e57373; }
        .badge-port-trade { background: #1976d2; }
        .badge-port-coastal { background: #64b5f6; }
        .badge-dock { background: #388e3c; }
        
        /* í†µê³„ íŒ¨ë„ */
        .stats-panel {
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 15px rgba(0,0,0,0.2);
            font-size: 12px;
        }
        
        .stats-panel h4 {
            margin-bottom: 10px;
            color: #1a237e;
            font-size: 14px;
            border-bottom: 2px solid #1a237e;
            padding-bottom: 5px;
        }
        
        .stat-item {
            display: flex;
            justify-content: space-between;
            margin: 5px 0;
            padding: 3px 0;
        }
        
        .stat-value {
            font-weight: 600;
            color: #1a237e;
        }
        
        /* ê²€ìƒ‰ íŒ¨ë„ */
        .search-panel {
            background: white;
            padding: 10px;
            border-radius: 8px;
            box-shadow: 0 2px 15px rgba(0,0,0,0.2);
        }
        
        .search-panel input {
            width: 180px;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 20px;
            font-size: 13px;
            outline: none;
        }
        
        .search-panel input:focus {
            border-color: #1a237e;
        }
        
        /* ë§ˆì»¤ ì•„ì´ì½˜ ìŠ¤íƒ€ì¼ */
        .custom-marker {
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            border: 3px solid white;
            box-shadow: 0 2px 8px rgba(0,0,0,0.3);
            font-size: 12px;
            font-weight: bold;
            color: white;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸš¢ ëŒ€í•œë¯¼êµ­ ì¡°ì„ ì†ŒÂ·í•­ë§ŒÂ·ë„í¬ ì¸í„°ë™í‹°ë¸Œ ì§€ë„</h1>
        <div class="header-info">ì´ 45ê°œ ì‹œì„¤ | OpenStreetMap ê¸°ë°˜ | 2025ë…„ 1ì›” ê¸°ì¤€</div>
    </div>
    
    <div id="map"></div>
    
    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    <!-- Leaflet MarkerCluster JS -->
    <script src="https://unpkg.com/leaflet.markercluster@1.4.1/dist/leaflet.markercluster.js"></script>
    
    <script>
        // ============================================
        // ëŒ€í•œë¯¼êµ­ ì¡°ì„ ì†ŒÂ·í•­ë§ŒÂ·ë„í¬ ë°ì´í„°
        // ============================================
        const facilitiesData = [
            // ëŒ€í˜• ì¡°ì„ ì†Œ
            { id: 1, name: "HDí˜„ëŒ€ì¤‘ê³µì—… ìš¸ì‚°ì¡°ì„ ì†Œ", category: "ì¡°ì„ ì†Œ", subcategory: "ëŒ€í˜•", region: "ìš¸ì‚°ê´‘ì—­ì‹œ", city: "ë™êµ¬", lat: 35.5089, lng: 129.4208, note: "ì„¸ê³„ ìµœëŒ€ ë‹¨ì¼ ì¡°ì„ ì†Œ/ë“œë¼ì´ë„í¬ 9ê¸° ë³´ìœ " },
            { id: 2, name: "ì‚¼ì„±ì¤‘ê³µì—… ê±°ì œì¡°ì„ ì†Œ", category: "ì¡°ì„ ì†Œ", subcategory: "ëŒ€í˜•", region: "ê²½ìƒë‚¨ë„", city: "ê±°ì œì‹œ", lat: 34.8847, lng: 128.6339, note: "3ê°œ ë„í¬ ë³´ìœ /ì„¸ê³„ì  ê·œëª¨ 3ë„í¬(640mÃ—97.5m)" },
            { id: 3, name: "í•œí™”ì˜¤ì…˜ ê±°ì œì¡°ì„ ì†Œ", category: "ì¡°ì„ ì†Œ", subcategory: "ëŒ€í˜•", region: "ê²½ìƒë‚¨ë„", city: "ê±°ì œì‹œ", lat: 34.8564, lng: 128.7089, note: "êµ¬ ëŒ€ìš°ì¡°ì„ í•´ì–‘/ì˜¥í¬ì¡°ì„ ì†Œ" },
            { id: 4, name: "HDí˜„ëŒ€ì‚¼í˜¸ ì˜ì•”ì¡°ì„ ì†Œ", category: "ì¡°ì„ ì†Œ", subcategory: "ëŒ€í˜•", region: "ì „ë¼ë‚¨ë„", city: "ì˜ì•”êµ°", lat: 34.7689, lng: 126.4156, note: "ì´ˆëŒ€í˜• ë„í¬ 2ê¸° ë³´ìœ /LNGì¶”ì§„ì„  ì „ë¬¸" },
            { id: 5, name: "HDí˜„ëŒ€ë¯¸í¬ ìš¸ì‚°ì¡°ì„ ì†Œ", category: "ì¡°ì„ ì†Œ", subcategory: "ëŒ€í˜•", region: "ìš¸ì‚°ê´‘ì—­ì‹œ", city: "ë™êµ¬", lat: 35.4917, lng: 129.4197, note: "ë„í¬ 4ê¸°/ì¤‘í˜•ì„  ì„¸ê³„1ìœ„" },
            
            // ì¤‘ì†Œ ì¡°ì„ ì†Œ
            { id: 6, name: "ì¼€ì´ì¡°ì„  ì§„í•´ì¡°ì„ ì†Œ", category: "ì¡°ì„ ì†Œ", subcategory: "ì¤‘ì†Œ", region: "ê²½ìƒë‚¨ë„", city: "ì°½ì›ì‹œ", lat: 35.0847, lng: 128.7139, note: "êµ¬ STXì¡°ì„ í•´ì–‘/íƒ±ì»¤Â·LNGë²™ì»¤ì„  íŠ¹í™”" },
            { id: 7, name: "HJì¤‘ê³µì—… ì˜ë„ì¡°ì„ ì†Œ", category: "ì¡°ì„ ì†Œ", subcategory: "ì¤‘ì†Œ", region: "ë¶€ì‚°ê´‘ì—­ì‹œ", city: "ì˜ë„êµ¬", lat: 35.0764, lng: 129.0478, note: "êµ­ë‚´ ìµœì´ˆ ì¡°ì„ ì†Œ(1937ë…„)/í•¨ì •ê±´ì¡° ëª…ê°€" },
            { id: 8, name: "ëŒ€ì„ ì¡°ì„  ì˜ë„ì¡°ì„ ì†Œ", category: "ì¡°ì„ ì†Œ", subcategory: "ì¤‘ì†Œ", region: "ë¶€ì‚°ê´‘ì—­ì‹œ", city: "ì˜ë„êµ¬", lat: 35.0742, lng: 129.0514, note: "ì¤‘ì†Œí˜• ì„ ë°• ê±´ì¡°/ì¹´í˜ë¦¬ ì „ë¬¸" },
            { id: 9, name: "ëŒ€í•œì¡°ì„  í•´ë‚¨ì¡°ì„ ì†Œ", category: "ì¡°ì„ ì†Œ", subcategory: "ì¤‘ì†Œ", region: "ì „ë¼ë‚¨ë„", city: "í•´ë‚¨êµ°", lat: 34.5789, lng: 126.4678, note: "ì¤‘í˜• ì¡°ì„ ì†Œ 1ìœ„/ì•„í”„ë¼ë§‰ìŠ¤ ìœ ì¡°ì„  ì „ë¬¸" },
            { id: 10, name: "HSGì„±ë™ì¡°ì„  í†µì˜ì¡°ì„ ì†Œ", category: "ì¡°ì„ ì†Œ", subcategory: "ì¤‘ì†Œ", region: "ê²½ìƒë‚¨ë„", city: "í†µì˜ì‹œ", lat: 34.8356, lng: 128.3928, note: "êµ¬ ì„±ë™ì¡°ì„ í•´ì–‘/ìœ¡ìƒê±´ì¡° íŠ¹í™”" },
            { id: 11, name: "SKì˜¤ì…˜í”ŒëœíŠ¸ ê³ ì„±ì¡°ì„ ì†Œ", category: "ì¡°ì„ ì†Œ", subcategory: "ì¤‘ì†Œ", region: "ê²½ìƒë‚¨ë„", city: "ê³ ì„±êµ°", lat: 34.9178, lng: 128.3067, note: "êµ¬ ì‚¼ê°•ì— ì•¤í‹°/í•´ì–‘í”ŒëœíŠ¸" },
            { id: 12, name: "HDí˜„ëŒ€ì¤‘ê³µì—… êµ°ì‚°ì¡°ì„ ì†Œ", category: "ì¡°ì„ ì†Œ", subcategory: "ì¤‘ì†Œ", region: "ì „ë¼ë¶ë„", city: "êµ°ì‚°ì‹œ", lat: 35.9547, lng: 126.6947, note: "2023ë…„ ì¬ê°€ë™/ë¸”ë¡ ìƒì‚°" },
            
            // ë¬´ì—­í•­
            { id: 13, name: "ë¶€ì‚°í•­ ë¶í•­", category: "í•­ë§Œ", subcategory: "ë¬´ì—­í•­", region: "ë¶€ì‚°ê´‘ì—­ì‹œ", city: "ì¤‘êµ¬", lat: 35.1028, lng: 129.0369, note: "ëŒ€í•œë¯¼êµ­ ìµœëŒ€ í•­ë§Œ" },
            { id: 14, name: "ë¶€ì‚°í•­ ì‹ í•­", category: "í•­ë§Œ", subcategory: "ë¬´ì—­í•­", region: "ë¶€ì‚°ê´‘ì—­ì‹œ", city: "ê°•ì„œêµ¬", lat: 35.0756, lng: 128.8514, note: "ì„¸ê³„ 5ìœ„ ì»¨í…Œì´ë„ˆí•­" },
            { id: 15, name: "ì¸ì²œí•­", category: "í•­ë§Œ", subcategory: "ë¬´ì—­í•­", region: "ì¸ì²œê´‘ì—­ì‹œ", city: "ì¤‘êµ¬", lat: 37.4519, lng: 126.6031, note: "ìˆ˜ë„ê¶Œ ê´€ë¬¸í•­" },
            { id: 16, name: "ìš¸ì‚°í•­", category: "í•­ë§Œ", subcategory: "ë¬´ì—­í•­", region: "ìš¸ì‚°ê´‘ì—­ì‹œ", city: "ë‚¨êµ¬", lat: 35.5008, lng: 129.4028, note: "ì„ìœ í™”í•™ ì¤‘ì‹¬ í•­ë§Œ" },
            { id: 17, name: "ê´‘ì–‘í•­", category: "í•­ë§Œ", subcategory: "ë¬´ì—­í•­", region: "ì „ë¼ë‚¨ë„", city: "ê´‘ì–‘ì‹œ", lat: 34.9108, lng: 127.6939, note: "ì œì² /ì»¨í…Œì´ë„ˆ ë³µí•©í•­" },
            { id: 18, name: "í‰íƒÂ·ë‹¹ì§„í•­", category: "í•­ë§Œ", subcategory: "ë¬´ì—­í•­", region: "ê²½ê¸°ë„", city: "í‰íƒì‹œ", lat: 36.9778, lng: 126.8231, note: "ì¤‘êµ­ êµì—­ ì¤‘ì‹¬í•­" },
            { id: 19, name: "ëª©í¬í•­", category: "í•­ë§Œ", subcategory: "ë¬´ì—­í•­", region: "ì „ë¼ë‚¨ë„", city: "ëª©í¬ì‹œ", lat: 34.7847, lng: 126.3756, note: "ì„œë‚¨ê¶Œ ê´€ë¬¸í•­" },
            { id: 20, name: "ì—¬ìˆ˜Â·ê´‘ì–‘í•­", category: "í•­ë§Œ", subcategory: "ë¬´ì—­í•­", region: "ì „ë¼ë‚¨ë„", city: "ì—¬ìˆ˜ì‹œ", lat: 34.7428, lng: 127.7478, note: "ì„ìœ í™”í•™ ë¬¼ë¥˜ ì¤‘ì‹¬" },
            { id: 21, name: "ë§ˆì‚°í•­", category: "í•­ë§Œ", subcategory: "ë¬´ì—­í•­", region: "ê²½ìƒë‚¨ë„", city: "ì°½ì›ì‹œ", lat: 35.1839, lng: 128.5694, note: "ê²½ë‚¨ê¶Œ ë¬´ì—­í•­" },
            { id: 22, name: "í¬í•­í•­", category: "í•­ë§Œ", subcategory: "ë¬´ì—­í•­", region: "ê²½ìƒë¶ë„", city: "í¬í•­ì‹œ", lat: 36.0219, lng: 129.3847, note: "ì œì²  ì§€ì›í•­" },
            { id: 23, name: "ë™í•´Â·ë¬µí˜¸í•­", category: "í•­ë§Œ", subcategory: "ë¬´ì—­í•­", region: "ê°•ì›ë„", city: "ë™í•´ì‹œ", lat: 37.5247, lng: 129.1147, note: "ì„íƒ„Â·ì‹œë©˜íŠ¸ ë¬¼ë¥˜" },
            { id: 24, name: "êµ°ì‚°í•­", category: "í•­ë§Œ", subcategory: "ë¬´ì—­í•­", region: "ì „ë¼ë¶ë„", city: "êµ°ì‚°ì‹œ", lat: 35.9789, lng: 126.7108, note: "ìƒˆë§Œê¸ˆ ì—°ê³„í•­" },
            { id: 25, name: "ëŒ€ì‚°í•­", category: "í•­ë§Œ", subcategory: "ë¬´ì—­í•­", region: "ì¶©ì²­ë‚¨ë„", city: "ì„œì‚°ì‹œ", lat: 36.9847, lng: 126.3528, note: "ì„ìœ í™”í•™ ì „ìš©í•­" },
            
            // ë„í¬
            { id: 26, name: "HDí˜„ëŒ€ì¤‘ê³µì—… 1ë„í¬", category: "ë„í¬", subcategory: "ê±´ë„í¬", region: "ìš¸ì‚°ê´‘ì—­ì‹œ", city: "ë™êµ¬", lat: 35.5067, lng: 129.4189, note: "VLCCê¸‰ ê±´ì¡°ê°€ëŠ¥ [ì¶”ì •ì¢Œí‘œ]" },
            { id: 27, name: "HDí˜„ëŒ€ì¤‘ê³µì—… í•´ì–‘ë„í¬", category: "ë„í¬", subcategory: "ê±´ë„í¬", region: "ìš¸ì‚°ê´‘ì—­ì‹œ", city: "ë™êµ¬", lat: 35.5142, lng: 129.4267, note: "í•´ì–‘í”ŒëœíŠ¸ ì „ìš© [ì¶”ì •ì¢Œí‘œ]" },
            { id: 28, name: "ì‚¼ì„±ì¤‘ê³µì—… 1ë„í¬", category: "ë„í¬", subcategory: "ê±´ë„í¬", region: "ê²½ìƒë‚¨ë„", city: "ê±°ì œì‹œ", lat: 34.8867, lng: 128.6319, note: "ëŒ€í˜• ì»¨í…Œì´ë„ˆì„  [ì¶”ì •ì¢Œí‘œ]" },
            { id: 29, name: "ì‚¼ì„±ì¤‘ê³µì—… 2ë„í¬", category: "ë„í¬", subcategory: "ê±´ë„í¬", region: "ê²½ìƒë‚¨ë„", city: "ê±°ì œì‹œ", lat: 34.8847, lng: 128.6339, note: "LNGì„  ê±´ì¡° [ì¶”ì •ì¢Œí‘œ]" },
            { id: 30, name: "ì‚¼ì„±ì¤‘ê³µì—… 3ë„í¬", category: "ë„í¬", subcategory: "ê±´ë„í¬", region: "ê²½ìƒë‚¨ë„", city: "ê±°ì œì‹œ", lat: 34.8827, lng: 128.6359, note: "ì„¸ê³„ì  ê·œëª¨(640mÃ—97.5m) [ì¶”ì •ì¢Œí‘œ]" },
            { id: 31, name: "í•œí™”ì˜¤ì…˜ 1ë„í¬", category: "ë„í¬", subcategory: "ê±´ë„í¬", region: "ê²½ìƒë‚¨ë„", city: "ê±°ì œì‹œ", lat: 34.8544, lng: 128.7069, note: "ëŒ€í˜•ì„  ê±´ì¡°(530mÃ—130m) [ì¶”ì •ì¢Œí‘œ]" },
            { id: 32, name: "í•œí™”ì˜¤ì…˜ ìˆ˜ë¦¬ë„í¬", category: "ë„í¬", subcategory: "ê±´ë„í¬", region: "ê²½ìƒë‚¨ë„", city: "ê±°ì œì‹œ", lat: 34.8584, lng: 128.7109, note: "30ë§Œí†¤ê¸‰ ìˆ˜ë¦¬ìš© [ì¶”ì •ì¢Œí‘œ]" },
            { id: 33, name: "HDí˜„ëŒ€ì‚¼í˜¸ 1ë„í¬", category: "ë„í¬", subcategory: "ê±´ë„í¬", region: "ì „ë¼ë‚¨ë„", city: "ì˜ì•”êµ°", lat: 34.7669, lng: 126.4136, note: "ì´ˆëŒ€í˜• ë„í¬ [ì¶”ì •ì¢Œí‘œ]" },
            { id: 34, name: "HDí˜„ëŒ€ì‚¼í˜¸ 2ë„í¬", category: "ë„í¬", subcategory: "ê±´ë„í¬", region: "ì „ë¼ë‚¨ë„", city: "ì˜ì•”êµ°", lat: 34.7709, lng: 126.4176, note: "ì´ˆëŒ€í˜• ë„í¬ [ì¶”ì •ì¢Œí‘œ]" },
            { id: 35, name: "HDí˜„ëŒ€ë¯¸í¬ 1ë„í¬", category: "ë„í¬", subcategory: "ê±´ë„í¬", region: "ìš¸ì‚°ê´‘ì—­ì‹œ", city: "ë™êµ¬", lat: 35.4897, lng: 129.4177, note: "380mÃ—65m [ì¶”ì •ì¢Œí‘œ]" },
            { id: 36, name: "HDí˜„ëŒ€ë¯¸í¬ 2ë„í¬", category: "ë„í¬", subcategory: "ê±´ë„í¬", region: "ìš¸ì‚°ê´‘ì—­ì‹œ", city: "ë™êµ¬", lat: 35.4917, lng: 129.4197, note: "380mÃ—65m [ì¶”ì •ì¢Œí‘œ]" },
            { id: 37, name: "HDí˜„ëŒ€ë¯¸í¬ 3ë„í¬", category: "ë„í¬", subcategory: "ê±´ë„í¬", region: "ìš¸ì‚°ê´‘ì—­ì‹œ", city: "ë™êµ¬", lat: 35.4937, lng: 129.4217, note: "380mÃ—65m [ì¶”ì •ì¢Œí‘œ]" },
            
            // ì—°ì•ˆí•­
            { id: 38, name: "ê°ì²œí•­", category: "í•­ë§Œ", subcategory: "ì—°ì•ˆí•­", region: "ë¶€ì‚°ê´‘ì—­ì‹œ", city: "ì‚¬í•˜êµ¬", lat: 35.0728, lng: 128.9839, note: "ì—°ì•ˆ ì–´í•­" },
            { id: 39, name: "ì¥ìƒí¬í•­", category: "í•­ë§Œ", subcategory: "ì—°ì•ˆí•­", region: "ìš¸ì‚°ê´‘ì—­ì‹œ", city: "ë‚¨êµ¬", lat: 35.4928, lng: 129.3847, note: "ê³¼ê±° í¬ê²½ ì¤‘ì‹¬ì§€" },
            { id: 40, name: "ì˜¨ì‚°í•­", category: "í•­ë§Œ", subcategory: "ì—°ì•ˆí•­", region: "ìš¸ì‚°ê´‘ì—­ì‹œ", city: "ìš¸ì£¼êµ°", lat: 35.4347, lng: 129.3628, note: "ì„ìœ í™”í•™ ì§€ì›í•­" },
            { id: 41, name: "ì§„í•´í•­", category: "í•­ë§Œ", subcategory: "ì—°ì•ˆí•­", region: "ê²½ìƒë‚¨ë„", city: "ì°½ì›ì‹œ", lat: 35.1147, lng: 128.6778, note: "í•´êµ°ì‘ì „ì‚¬ë ¹ë¶€ ì¸ê·¼" },
            { id: 42, name: "í†µì˜í•­", category: "í•­ë§Œ", subcategory: "ì—°ì•ˆí•­", region: "ê²½ìƒë‚¨ë„", city: "í†µì˜ì‹œ", lat: 34.8428, lng: 128.4228, note: "ìˆ˜ì‚°ë¬¼ ì¤‘ì‹¬" },
            { id: 43, name: "ì‚¼ì²œí¬í•­", category: "í•­ë§Œ", subcategory: "ì—°ì•ˆí•­", region: "ê²½ìƒë‚¨ë„", city: "ì‚¬ì²œì‹œ", lat: 34.9247, lng: 128.0678, note: "ì—°ì•ˆ ì–´í•­" },
            { id: 44, name: "ì†ì´ˆí•­", category: "í•­ë§Œ", subcategory: "ì—°ì•ˆí•­", region: "ê°•ì›ë„", city: "ì†ì´ˆì‹œ", lat: 38.2078, lng: 128.5947, note: "ë™í•´ì•ˆ ê´€ê´‘í•­" },
            { id: 45, name: "ëŒ€í¬í•­", category: "í•­ë§Œ", subcategory: "ì—°ì•ˆí•­", region: "ê°•ì›ë„", city: "ê°•ë¦‰ì‹œ", lat: 37.7928, lng: 128.9128, note: "ë™í•´ì•ˆ ì–´í•­" }
        ];
        
        // ============================================
        // ìƒ‰ìƒ ë° ì•„ì´ì½˜ ì„¤ì •
        // ============================================
        const colorScheme = {
            "ì¡°ì„ ì†Œ-ëŒ€í˜•": "#d32f2f",
            "ì¡°ì„ ì†Œ-ì¤‘ì†Œ": "#e57373",
            "í•­ë§Œ-ë¬´ì—­í•­": "#1976d2",
            "í•­ë§Œ-ì—°ì•ˆí•­": "#64b5f6",
            "ë„í¬-ê±´ë„í¬": "#388e3c",
            "ë„í¬-ë¶€ìœ ë„í¬": "#81c784"
        };
        
        function getColor(category, subcategory) {
            return colorScheme[`${category}-${subcategory}`] || "#757575";
        }
        
        function createCustomIcon(category, subcategory) {
            const color = getColor(category, subcategory);
            const size = category === "ë„í¬" ? 10 : (subcategory === "ëŒ€í˜•" || subcategory === "ë¬´ì—­í•­" ? 16 : 12);
            
            return L.divIcon({
                className: 'custom-div-icon',
                html: `<div style="
                    background-color: ${color};
                    width: ${size}px;
                    height: ${size}px;
                    border-radius: 50%;
                    border: 2px solid white;
                    box-shadow: 0 2px 5px rgba(0,0,0,0.3);
                "></div>`,
                iconSize: [size, size],
                iconAnchor: [size/2, size/2]
            });
        }
        
        // ============================================
        // ì§€ë„ ì´ˆê¸°í™”
        // ============================================
        const map = L.map('map', {
            center: [36.0, 127.5],
            zoom: 7,
            minZoom: 6,
            maxZoom: 18
        });
        
        // ë² ì´ìŠ¤ë§µ ë ˆì´ì–´
        const osmLayer = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        });
        
        const cartoLight = L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>'
        });
        
        const cartoDark = L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>'
        });
        
        // ê¸°ë³¸ ë ˆì´ì–´ ì¶”ê°€
        cartoLight.addTo(map);
        
        // ============================================
        // ë§ˆì»¤ ë ˆì´ì–´ ê·¸ë£¹ ìƒì„±
        // ============================================
        const shipyardLargeLayer = L.layerGroup();
        const shipyardSmallLayer = L.layerGroup();
        const portTradeLayer = L.layerGroup();
        const portCoastalLayer = L.layerGroup();
        const dockLayer = L.layerGroup();
        
        // ë°ì´í„°ë¥¼ ë ˆì´ì–´ì— ì¶”ê°€
        facilitiesData.forEach(facility => {
            const marker = L.marker([facility.lat, facility.lng], {
                icon: createCustomIcon(facility.category, facility.subcategory)
            });
            
            // íŒì—… ë‚´ìš© ìƒì„±
            const badgeClass = facility.category === "ì¡°ì„ ì†Œ" ? 
                (facility.subcategory === "ëŒ€í˜•" ? "badge-shipyard-large" : "badge-shipyard-small") :
                facility.category === "í•­ë§Œ" ?
                (facility.subcategory === "ë¬´ì—­í•­" ? "badge-port-trade" : "badge-port-coastal") :
                "badge-dock";
            
            const popupContent = `
                <div class="popup-content">
                    <h3>${facility.name}</h3>
                    <div class="info-row">
                        <span class="info-label">êµ¬ë¶„</span>
                        <span class="info-value">
                            <span class="category-badge ${badgeClass}">${facility.category} - ${facility.subcategory}</span>
                        </span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">ì§€ì—­</span>
                        <span class="info-value">${facility.region} ${facility.city}</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">ì¢Œí‘œ</span>
                        <span class="info-value">${facility.lat.toFixed(4)}, ${facility.lng.toFixed(4)}</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">ë¹„ê³ </span>
                        <span class="info-value">${facility.note}</span>
                    </div>
                </div>
            `;
            
            marker.bindPopup(popupContent, { className: 'custom-popup', maxWidth: 300 });
            
            // ë ˆì´ì–´ ë¶„ë¥˜
            if (facility.category === "ì¡°ì„ ì†Œ" && facility.subcategory === "ëŒ€í˜•") {
                shipyardLargeLayer.addLayer(marker);
            } else if (facility.category === "ì¡°ì„ ì†Œ" && facility.subcategory === "ì¤‘ì†Œ") {
                shipyardSmallLayer.addLayer(marker);
            } else if (facility.category === "í•­ë§Œ" && facility.subcategory === "ë¬´ì—­í•­") {
                portTradeLayer.addLayer(marker);
            } else if (facility.category === "í•­ë§Œ" && facility.subcategory === "ì—°ì•ˆí•­") {
                portCoastalLayer.addLayer(marker);
            } else if (facility.category === "ë„í¬") {
                dockLayer.addLayer(marker);
            }
        });
        
        // ê¸°ë³¸ìœ¼ë¡œ ëª¨ë“  ë ˆì´ì–´ í‘œì‹œ
        shipyardLargeLayer.addTo(map);
        shipyardSmallLayer.addTo(map);
        portTradeLayer.addTo(map);
        portCoastalLayer.addTo(map);
        dockLayer.addTo(map);
        
        // ============================================
        // ë ˆì´ì–´ ì»¨íŠ¸ë¡¤ íŒ¨ë„
        // ============================================
        const layerControl = L.control({ position: 'topright' });
        layerControl.onAdd = function(map) {
            const div = L.DomUtil.create('div', 'layer-control');
            div.innerHTML = `
                <h4>ğŸ—‚ï¸ ë ˆì´ì–´ ì„ íƒ</h4>
                <div class="layer-item">
                    <input type="checkbox" id="layer-shipyard-large" checked>
                    <label for="layer-shipyard-large">
                        <span class="legend-icon" style="background:#d32f2f; display:inline-block; width:12px; height:12px; border-radius:50%; margin-right:5px;"></span>
                        ëŒ€í˜• ì¡°ì„ ì†Œ (${facilitiesData.filter(f => f.category === "ì¡°ì„ ì†Œ" && f.subcategory === "ëŒ€í˜•").length})
                    </label>
                </div>
                <div class="layer-item">
                    <input type="checkbox" id="layer-shipyard-small" checked>
                    <label for="layer-shipyard-small">
                        <span class="legend-icon" style="background:#e57373; display:inline-block; width:12px; height:12px; border-radius:50%; margin-right:5px;"></span>
                        ì¤‘ì†Œ ì¡°ì„ ì†Œ (${facilitiesData.filter(f => f.category === "ì¡°ì„ ì†Œ" && f.subcategory === "ì¤‘ì†Œ").length})
                    </label>
                </div>
                <div class="layer-item">
                    <input type="checkbox" id="layer-port-trade" checked>
                    <label for="layer-port-trade">
                        <span class="legend-icon" style="background:#1976d2; display:inline-block; width:12px; height:12px; border-radius:50%; margin-right:5px;"></span>
                        ë¬´ì—­í•­ (${facilitiesData.filter(f => f.category === "í•­ë§Œ" && f.subcategory === "ë¬´ì—­í•­").length})
                    </label>
                </div>
                <div class="layer-item">
                    <input type="checkbox" id="layer-port-coastal" checked>
                    <label for="layer-port-coastal">
                        <span class="legend-icon" style="background:#64b5f6; display:inline-block; width:12px; height:12px; border-radius:50%; margin-right:5px;"></span>
                        ì—°ì•ˆí•­ (${facilitiesData.filter(f => f.category === "í•­ë§Œ" && f.subcategory === "ì—°ì•ˆí•­").length})
                    </label>
                </div>
                <div class="layer-item">
                    <input type="checkbox" id="layer-dock" checked>
                    <label for="layer-dock">
                        <span class="legend-icon" style="background:#388e3c; display:inline-block; width:12px; height:12px; border-radius:50%; margin-right:5px;"></span>
                        ë„í¬ (${facilitiesData.filter(f => f.category === "ë„í¬").length})
                    </label>
                </div>
            `;
            
            // ì´ë²¤íŠ¸ ì „íŒŒ ë°©ì§€
            L.DomEvent.disableClickPropagation(div);
            
            return div;
        };
        layerControl.addTo(map);
        
        // ë ˆì´ì–´ í† ê¸€ ì´ë²¤íŠ¸
        document.getElementById('layer-shipyard-large').addEventListener('change', function(e) {
            e.target.checked ? map.addLayer(shipyardLargeLayer) : map.removeLayer(shipyardLargeLayer);
        });
        document.getElementById('layer-shipyard-small').addEventListener('change', function(e) {
            e.target.checked ? map.addLayer(shipyardSmallLayer) : map.removeLayer(shipyardSmallLayer);
        });
        document.getElementById('layer-port-trade').addEventListener('change', function(e) {
            e.target.checked ? map.addLayer(portTradeLayer) : map.removeLayer(portTradeLayer);
        });
        document.getElementById('layer-port-coastal').addEventListener('change', function(e) {
            e.target.checked ? map.addLayer(portCoastalLayer) : map.removeLayer(portCoastalLayer);
        });
        document.getElementById('layer-dock').addEventListener('change', function(e) {
            e.target.checked ? map.addLayer(dockLayer) : map.removeLayer(dockLayer);
        });
        
        // ============================================
        // ê²€ìƒ‰ íŒ¨ë„
        // ============================================
        const searchControl = L.control({ position: 'topleft' });
        searchControl.onAdd = function(map) {
            const div = L.DomUtil.create('div', 'search-panel');
            div.innerHTML = `<input type="text" id="search-input" placeholder="ğŸ” ì‹œì„¤ëª… ê²€ìƒ‰...">`;
            L.DomEvent.disableClickPropagation(div);
            return div;
        };
        searchControl.addTo(map);
        
        // ê²€ìƒ‰ ê¸°ëŠ¥
        document.getElementById('search-input').addEventListener('input', function(e) {
            const searchTerm = e.target.value.toLowerCase();
            if (searchTerm.length < 2) return;
            
            const found = facilitiesData.find(f => f.name.toLowerCase().includes(searchTerm));
            if (found) {
                map.setView([found.lat, found.lng], 12);
            }
        });
        
        // ============================================
        // ë² ì´ìŠ¤ë§µ ì„ íƒ ì»¨íŠ¸ë¡¤
        // ============================================
        const baseMaps = {
            "ë°ì€ ì§€ë„": cartoLight,
            "ì–´ë‘ìš´ ì§€ë„": cartoDark,
            "OpenStreetMap": osmLayer
        };
        
        L.control.layers(baseMaps, null, { position: 'bottomright' }).addTo(map);
        
        // ============================================
        // í†µê³„ íŒ¨ë„
        // ============================================
        const statsControl = L.control({ position: 'bottomleft' });
        statsControl.onAdd = function(map) {
            const div = L.DomUtil.create('div', 'stats-panel');
            
            const shipyardCount = facilitiesData.filter(f => f.category === "ì¡°ì„ ì†Œ").length;
            const portCount = facilitiesData.filter(f => f.category === "í•­ë§Œ").length;
            const dockCount = facilitiesData.filter(f => f.category === "ë„í¬").length;
            
            div.innerHTML = `
                <h4>ğŸ“Š ì‹œì„¤ í†µê³„</h4>
                <div class="stat-item">
                    <span>ì „ì²´ ì‹œì„¤</span>
                    <span class="stat-value">${facilitiesData.length}ê°œ</span>
                </div>
                <div class="stat-item">
                    <span>ì¡°ì„ ì†Œ</span>
                    <span class="stat-value">${shipyardCount}ê°œ</span>
                </div>
                <div class="stat-item">
                    <span>í•­ë§Œ</span>
                    <span class="stat-value">${portCount}ê°œ</span>
                </div>
                <div class="stat-item">
                    <span>ë„í¬</span>
                    <span class="stat-value">${dockCount}ê°œ</span>
                </div>
            `;
            
            L.DomEvent.disableClickPropagation(div);
            return div;
        };
        statsControl.addTo(map);
        
        // ============================================
        // ìŠ¤ì¼€ì¼ ë°” ì¶”ê°€
        // ============================================
        L.control.scale({ metric: true, imperial: false }).addTo(map);
    </script>
</body>
</html>
